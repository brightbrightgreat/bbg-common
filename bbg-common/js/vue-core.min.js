new Vue({el:"#vue-app",data:window.bbgEnv||{},methods:{onScroll:function(){this.window.scrollDirection=this.window.scrolled<window.scrollY?"down":"up",this.window.scrolled=window.scrollY},onLoad:function(){var vue=this;if(this.onResize(),this.session.n=Cookies.get("bbg_common_n")||"",this.session.n?setTimeout(function(){vue.heartbeat(vue)},18e5):vue.heartbeat(vue),void 0!==this.archive&&this.archive.pages>this.archive.page&&this.archive.marker&&"string"==typeof this.archive.marker&&"string"==typeof this.archive.base&&-1!==this.archive.base.indexOf("%#%")){var archiveObserverEl=document.getElementById(this.archive.marker);archiveObserverEl&&(this.archive.offset=parseInt(this.archive.offset,10)||0,new IntersectionObserver(function(entries,archiveObserver){entries[0].isIntersecting&&vue.infiniteScroll(),!0===vue.infiniteDone&&(archiveObserver.unobserve(archiveObserverEl),archiveObserverEl.parentNode.removeChild(archiveObserverEl))},{root:null,rootMargin:this.archive.offset+"px",threshold:1}).observe(archiveObserverEl))}},onResize:blobThrottle(function(){this.window.width=window.innerWidth,this.window.height=window.innerHeight,this.window.width===this.window.height?this.window.aspect="square":this.window.width>this.window.height?this.window.aspect="landscape":this.window.aspect="portrait",this.onScroll()},100),infiniteLock:!1,infiniteDone:!1,infiniteScroll:function(){if(!0===this.infiniteLock||!this.archive)return this.archive||(this.infiniteDone=!0),!1;if(this.infiniteLock=!0,this.archive.posts&&Array.isArray(this.archive.posts)||(this.archive.posts=[]),++this.archive.page>this.archive.pages)return this.infiniteDone=!0,!1;var url=this.archive.base.replace("%#%",this.archive.page),vue=this;this.$http.get(url).then(function(r){if(!r.ok)return vue.infiniteLock=!1,vue.infiniteDone=!0,!1;try{var el=document.createElement("html");el.innerHTML=r.body;var i,script=el.getElementById("bbg-common-env").textContent,first=script.indexOf("bbgEnv={"),last=script.lastIndexOf("}");if(-1!==first&&-1!==last){var json=JSON.parse(script.substr(first+6,last-first-6));if(json.archive&&json.archive.posts&&Array.isArray(json.archive.posts)){for(i=0;i<json.archive.posts.length;i++)vue.archive.posts.push(json.archive.posts[i]);return vue.infiniteLock=!1,!0}}return vue.infiniteLock=!1,vue.infiniteDone=!0,!1}catch(Ex){}},function(r){vue.infiniteLock=!1,vue.infiniteDone=!0})}},mounted:function(){if(void 0!==this.session&&!1===this.session.vue){if(this.session.vue=!0,smoothScroll.init({selector:'a[href^="#"]',speed:1e3,offset:170}),window.location.hash)try{var anchor=document.querySelector(window.location.hash);anchor&&smoothScroll.animateScroll(anchor)}catch(Ex){}Element.prototype.isNodeList=function(){return!1},NodeList.prototype.isNodeList=HTMLCollection.prototype.isNodeList=function(){return!0},window.addEventListener("scroll",this.onScroll),window.addEventListener("resize",this.onResize),document.addEventListener("DOMContentLoaded",this.onLoad);var vue=this;document.addEventListener("keyup",function(e){("key"in(e=e||window.event)&&("Escape"===e.key||"Esc"===e.key)||27==e.keyCode)&&(vue.modal="")})}}});